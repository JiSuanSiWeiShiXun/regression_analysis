# 题目5 - 健身数据回归分析 - 快速总结

## 📊 数据概况
- **31个观测值**，测量男性体能指标与氧气消耗的关系
- **目标变量(Y)**：氧气消耗量 (ml/kg/min)
- **预测变量**：年龄、体重、跑步时间、三种脉搏率

---

## ✅ 问题(a): 多元线性回归模型

### 模型方程
```
Y = 102.24 - 0.22×X₁ - 0.07×X₂ - 2.68×X₃ - 0.001×X₄ - 0.37×X₅ + 0.30×X₆
```

### 关键结果
- **σ² = 5.39**（误差方差）
- **R² = 0.848**（解释84.8%的变异）
- **最重要变量：X₃（跑步时间）**，系数-2.68，相关系数-0.86

### 图表：question5_part_a_full_model.png
展示了完整模型的诊断图，包括实际vs预测值、残差分析、Q-Q图等。

---

## ✅ 问题(b): 线性模型变量选择

### 前向选择与后向消元结果

| 准则 | 选择的变量 | R² |
|------|-----------|-----|
| **BIC（推荐）** | X₃, X₁, X₅, X₆ | 0.8368 |
| AIC | X₃, X₁, X₅, X₆, X₂ | 0.8480 |

### 最简化模型（仅2个变量）
```
Y = 88.46 - 3.20×X₃ - 0.15×X₁
R² = 0.7642
```
**仅用跑步时间和年龄就能解释76%的变异！**

### 推荐模型（4个变量）
- **变量**：X₃（跑步时间）、X₁（年龄）、X₅（开始脉搏）、X₆（结束脉搏）
- **R² = 0.8368**
- **平衡了准确性和简洁性**

### 图表：question5_part_b_selection.png
展示了变量选择过程中AIC、BIC、Cp准则的变化趋势。

---

## ✅ 问题(c): 二次回归模型

### 模型特征
- **线性项**：6个
- **二次项和交互项**：21个  
- **总参数**：27个（相对31个观测，自由度仅3）

### 关键结果
- **σ² = 6.74**
- **R² = 0.976**（拟合近乎完美！）
- **调整R² = 0.763**（惩罚后大幅下降，提示过拟合）

### 重要的交互/二次项
1. **X₃²** = -0.757（跑步时间的二次效应）
2. **X₁×X₃** = -0.535（年龄与跑步时间的交互）
3. **X₃×X₆** = 0.327（跑步时间与结束脉搏的交互）

### ⚠️ 警告：过拟合风险
虽然R²=0.976看起来很好，但调整R²=0.763低于线性模型的0.810，说明模型过于复杂。

### 图表：question5_part_c_quadratic.png
展示了二次模型的诊断图和与线性模型的对比。

---

## ✅ 问题(d): 二次模型变量选择

### 前向选择结果（BIC准则）

| 步骤 | 特征数 | R² | BIC |
|------|-------|-----|-----|
| 1 | 1 | 0.7434 | 67.40 |
| 2 | 2 | 0.7982 | 63.38 |
| **3** | **3** | **0.8291** | **61.67** ← 最优 |
| 4 | 4 | 0.8390 | 63.25 |

### 最优二次模型（3个特征）
```
Y = 86.55 - 2.82×X₃ - 0.007×(X₁×X₅) + 0.006×(X₁×X₆)
```
- **R² = 0.8291**
- **调整R² = 0.8101**
- 包含跑步时间和两个交互项

### 图表：question5_part_d_quad_selection.png
展示了二次模型变量选择的过程和最优模型的诊断。

---

## 🎯 最终推荐

### 📌 推荐方案一：平衡模型（标准使用）
**变量**：X₃（跑步时间）、X₁（年龄）、X₅（开始脉搏）、X₆（结束脉搏）
- R² = 0.8368
- 4个变量，易于测量
- 准确性与实用性的最佳平衡

### 📌 推荐方案二：简化模型（快速评估）
**变量**：X₃（跑步时间）、X₁（年龄）
- R² = 0.7642
- 仅2个变量，极易实施
- 适合现场快速筛查

### 📌 推荐方案三：精细模型（研究用）
**变量**：X₃ + X₁×X₅ + X₁×X₆（包含交互项）
- R² = 0.8291
- 考虑了年龄与脉搏的交互效应
- 适合学术研究

---

## 📈 所有模型对比

| 模型 | 特征数 | R² | 调整R² | 优缺点 |
|------|-------|-----|--------|--------|
| 线性（完整） | 6 | 0.848 | 0.810 | 有冗余变量 |
| **线性（BIC）** | **4** | **0.837** | **0.820** | **✅ 推荐** |
| 线性（极简） | 2 | 0.764 | 0.747 | 最简单 |
| 二次（完整） | 27 | 0.976 | 0.763 | ⚠️ 过拟合 |
| 二次（BIC） | 3 | 0.829 | 0.810 | 交互效应 |

---

## 🔑 关键发现

1. **跑步时间是最强预测因子**
   - 单独解释74.3%的变异
   - 相关系数-0.86（强负相关）
   - 生理意义：有氧能力的直接体现

2. **简单模型足够有效**
   - 仅2个变量（跑步时间+年龄）就能达到76%准确率
   - 复杂模型虽然拟合更好，但过拟合风险高

3. **交互效应存在但不强**
   - 年龄与脉搏有一定交互作用
   - 但增益有限，增加复杂性

4. **变量选择方法一致**
   - 前向选择和后向消元得到相同结果
   - 增强了结论的可信度

---

## 📁 生成的文件

### 代码文件
- `question5/main.py` - 完整的分析代码

### 图表文件（PNG格式，300 DPI）
1. `question5_correlation_matrix.png` - 相关系数热图
2. `question5_part_a_full_model.png` - (a)完整线性模型诊断
3. `question5_part_b_selection.png` - (b)变量选择过程
4. `question5_part_c_quadratic.png` - (c)二次模型分析
5. `question5_part_d_quad_selection.png` - (d)二次模型变量选择

### 报告文件
- `分析报告.md` - 详细的中文分析报告

---

## 💡 实用建议

### 用于不同场景

1. **健身中心快速评估**
   - 只测：跑步时间、年龄
   - 使用简化模型（方案二）
   - 准确率：76%

2. **医疗健康评估**
   - 测量：跑步时间、年龄、开始/结束脉搏
   - 使用平衡模型（方案一）
   - 准确率：84%

3. **运动科学研究**
   - 完整测量所有指标
   - 使用交互模型（方案三）
   - 准确率：83%，包含交互效应

---

## ⚠️ 模型局限

1. 样本量较小（n=31）
2. 仅限男性数据
3. X₅和X₆高度相关（r=0.93）
4. 外推需谨慎

---

**分析完成！所有问题已解答，图表已生成。** ✅
